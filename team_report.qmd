---
title: "{{< meta params.season >}} Team Report"
subtitle: "{{< meta params.team >}}"
format: 
  html:
    echo: false
    warning: false
    message: false
params: 
  season: 2024
    team: Wisconsin
---


```{r}
#| include: false
# packages
library(targets)
library(dplyr)
library(tidyr)
library(ggplot2)
library(quarto)
library(gt)
library(gtExtras)
library(patchwork)

# src code
tar_source("R")

# team info
team_info <- cfbfastR::cfbd_team_info(year = params$season)

# estimates
team_scores = tar_read("team_scores")
team_category_estimates = tar_read("season_team_category_estimates")

```

# Season

```{r}

team_scores |>
  plot_team_score_by_season(team = params$team)
```

```{r}

team_scores |>
  plot_team_estimates_by_season(team = params$team)

```

```{r}

team_category_estimates |>
  plot_team_category_by_season(team = params$team)

```



```{r}
#| fig-height: 8
team_scores |>
  plot_team_by_season(team = params$team)
```


```{r}

team_category_estimates |>
  plot_team_category_by_season(team = params$team)

```

# Weekly

Estimated efficiency by week.

```{r}

team_scores |>
  plot_team_scores(team = params$team, rankings = c(25))
```

Last five full seasons including the current season.

```{r}

team_scores |>
  filter(season >= params$season -6) |>
  plot_team_scores(team = params$team, rankings = c(25))

```

## Pass/Run

```{r}

team_category_estimates |>
  plot_team_efficiency_by_category_and_week(team = params$team)

```

by play type

```{r}

team_category_estimates |>
  filter(season >= 2018) |>
  plot_team_efficiency_by_category_and_week(team = params$team)
```

# Tables

```{r}

team_scores |>
  team_efficiency_overall_tbl(team = params$team) |>
  gt::opt_interactive(page_size_default = 25) |>
  add_gt_formatting()

```


```{r}

team_category_estimates |> 
  find_team_season_score() |>
  filter(play_category != 'special') |>
  team_efficiency_category_tbl(team = params$team) |>
  gt::opt_interactive(page_size_default = 25) |>
  add_gt_formatting()

```